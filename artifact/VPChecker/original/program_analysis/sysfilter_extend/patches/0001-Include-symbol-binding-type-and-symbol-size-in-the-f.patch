From 549fec01311cd3e9df8906694dc680840ab2a3b7 Mon Sep 17 00:00:00 2001
From: Anon User <anon@anon>
Date: Tue, 21 Nov 2023 20:40:48 -0500
Subject: [PATCH 1/3] Include symbol binding type and symbol size in the final
 call graph JSON

---
 extraction/app/src/callgraph_writer.cpp | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/extraction/app/src/callgraph_writer.cpp b/extraction/app/src/callgraph_writer.cpp
index 59168d6..3006183 100644
--- a/extraction/app/src/callgraph_writer.cpp
+++ b/extraction/app/src/callgraph_writer.cpp
@@ -121,6 +121,14 @@ void CallgraphWriter::dump(nlohmann::json &obj) {
 
         fobj["entry_point"] = (entryPoints.count(func) != 0);
 
+        Symbol *sym = func->getSymbol();
+        if(sym) {
+            fobj["binding_type"] = sym->getBind();
+            fobj["symbol_size"] = sym->getSize();
+        }
+
+        fobj["dynamic_symbol"] = (func->getDynamicSymbol())?true:false;
+
         if (hasSyscallSiteInfo) {
             nlohmann::json sysObj = nlohmann::json::object();
             writeSyscallSiteInfo(func, sysObj);
-- 
2.34.1

